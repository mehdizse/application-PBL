import{c as L,d as E,q as $,w as b,g as I}from"./firebase.75af1a1b.js";const r=document.getElementById("articles-grid"),h=document.getElementById("loading"),u=document.getElementById("no-articles"),g=document.getElementById("empty-state"),a=document.getElementById("modal"),C=document.getElementById("close-modal"),w=document.getElementById("modal-content"),f=document.getElementById("search-input"),i=document.getElementById("format-filter"),m=document.getElementById("level-filter"),l=document.getElementById("sort-filter");let d=[];async function B(){try{const t=L(E,"articles"),n=$(t,b("status","==","published")),e=await I(n);d=[],e.forEach(o=>{d.push({id:o.id,...o.data()})}),D(),v(d)}catch(t){console.log("Erreur de chargement:",t),h.innerHTML='<p class="text-red-600">âŒ Erreur lors du chargement des articles</p>'}}function v(t){if(h.classList.add("hidden"),t.length===0){r.classList.add("hidden"),u.classList.remove("hidden"),g.classList.add("hidden");return}r.innerHTML="",t.forEach(n=>{const e=A(n);r.appendChild(e)}),r.classList.remove("hidden"),u.classList.add("hidden"),g.classList.add("hidden")}function A(t){const n=document.createElement("div");n.className="card p-6 hover:shadow-xl transition-all duration-300 cursor-pointer";const e=t.format==="photo"?"ğŸ“¸":"âœï¸",o=t.format==="photo"?"Format Photo":"Format Ã‰crit",s=t.format==="photo"?"pink":"purple";let p=t.content;t.format==="photo"&&(p=t.photoDescription||"Photo de production");const y=(t.tags||[]).map(x=>`<span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded">${x}</span>`).join("");return n.innerHTML=`
      <div class="flex items-center justify-between mb-4">
        <span class="text-3xl">${e}</span>
        <span class="text-xs bg-${s}-200 text-${s}-700 px-3 py-1 rounded-full">${o}</span>
      </div>
      <h4 class="text-lg font-bold text-gray-900 mb-2">${t.title}</h4>
      <p class="text-sm text-gray-600 mb-3"><strong>ğŸ‘¤ ${t.author}</strong> (${t.level})</p>
      <p class="text-sm text-gray-600 mb-3"><strong>ğŸ“š ${t.projectName}</strong></p>
      <p class="text-sm text-gray-700 mb-4 line-clamp-3">${p}</p>
      <div class="flex flex-wrap gap-2 mb-4">${y}</div>
      <p class="text-xs text-gray-500">ğŸ“… ${new Date(t.createdAt).toLocaleDateString("fr-FR")}</p>
    `,n.addEventListener("click",()=>M(t)),n}function M(t){const n=t.format==="photo"?"ğŸ“¸":"âœï¸";let e=`
      <div>
        <h2 class="text-3xl font-bold text-gray-900 mb-4">${t.title} ${n}</h2>
        <div class="space-y-4 text-gray-700">
          <div><strong>ğŸ‘¤ Auteur:</strong> ${t.author}</div>
          <div><strong>ğŸ“š Niveau:</strong> ${t.level}</div>
          <div><strong>ğŸ“– Projet:</strong> ${t.projectName}</div>
          <div><strong>ğŸ“ Contexte:</strong> ${t.description}</div>
    `;t.format==="photo"?e+=`<div><strong>ğŸ“¸ Description Photo:</strong> ${t.photoDescription}</div>`:e+=`<div class="mt-6 p-4 bg-gray-50 rounded border border-gray-200"><strong>ğŸ“„ Contenu:</strong><pre class="whitespace-pre-wrap mt-2">${t.content}</pre></div>`,e+="</div></div>",w.innerHTML=e,a.classList.remove("hidden")}function c(){let t=d;const n=f.value.toLowerCase();n&&(t=t.filter(e=>e.title.toLowerCase().includes(n)||e.author.toLowerCase().includes(n)||(e.tags||[]).some(o=>o.toLowerCase().includes(n)))),i.value&&(t=t.filter(e=>e.format===i.value)),m.value&&(t=t.filter(e=>e.level===m.value)),l.value==="recent"?t.sort((e,o)=>o.createdAt-e.createdAt):l.value==="ancien"?t.sort((e,o)=>e.createdAt-o.createdAt):l.value==="titre"&&t.sort((e,o)=>e.title.localeCompare(o.title)),v(t)}function D(){const t=d.length,n=d.filter(s=>s.format==="Ã©crit").length,e=d.filter(s=>s.format==="photo").length,o=new Set(d.map(s=>s.author)).size;document.getElementById("stat-total").textContent=t,document.getElementById("stat-text").textContent=n,document.getElementById("stat-photos").textContent=e,document.getElementById("stat-students").textContent=o}f.addEventListener("input",c);i.addEventListener("change",c);m.addEventListener("change",c);l.addEventListener("change",c);C.addEventListener("click",()=>{a.classList.add("hidden")});a.addEventListener("click",t=>{t.target===a&&a.classList.add("hidden")});B();
