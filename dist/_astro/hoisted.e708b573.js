import{o as w,e as x,a as I,f as v,c as g,d as y,h as b,r as q,i as D,j as k,k as $}from"./firebase.75af1a1b.js";const E=document.getElementById("auth-check"),L=document.getElementById("not-authenticated"),A=document.getElementById("logout-btn");w(I,a=>{a?(E.classList.remove("hidden"),L.classList.add("hidden"),j(a),F(),T()):(E.classList.add("hidden"),L.classList.remove("hidden"))});function F(){document.querySelectorAll(".format-tab").forEach(a=>{a.addEventListener("click",()=>{const t=a.dataset.format;document.querySelectorAll(".format-tab").forEach(e=>{e.classList.remove("active","border-purple-600","border-b-4"),e.classList.add("border-transparent","text-gray-600")}),a.classList.add("active","border-purple-600","border-b-4","text-gray-900"),document.querySelectorAll(".format-content").forEach(e=>{e.classList.add("hidden")}),document.getElementById(`${t}-form`).classList.remove("hidden")})})}function T(){const a=document.getElementById("photo-input"),t=document.getElementById("drag-drop-area");t&&(t.addEventListener("dragover",e=>{e.preventDefault(),t.classList.add("bg-purple-50","border-purple-600")}),t.addEventListener("dragleave",()=>{t.classList.remove("bg-purple-50","border-purple-600")}),t.addEventListener("drop",e=>{e.preventDefault(),t.classList.remove("bg-purple-50","border-purple-600"),e.dataTransfer.files.length&&(a.files=e.dataTransfer.files)}))}function j(a){const t=document.getElementById("text-form"),e=document.getElementById("photo-form");t&&t.addEventListener("submit",async c=>{c.preventDefault();const o=t.querySelectorAll('input[type="text"]'),d=t.querySelector("select"),n=t.querySelectorAll("textarea"),f=o[0].value,l=o[1].value,i=d.value,u=o[2].value,p=n[0].value,m=n[1].value,h=o[3].value.split(",").map(s=>s.trim()).filter(s=>s);try{await v(g(y,"articles"),{title:f,author:l,level:i,projectName:u,description:p,content:m,format:"écrit",tags:h,status:"published",userId:a.uid,createdAt:b()}),alert("✅ Article écrit publié avec succès!"),t.reset()}catch(s){alert(`❌ Erreur: ${s.message}`)}}),e&&e.addEventListener("submit",async c=>{c.preventDefault();const o=e.querySelectorAll('input[type="text"]'),d=e.querySelectorAll("select"),n=e.querySelectorAll("textarea"),l=document.getElementById("photo-input").files[0];if(!l){alert("❌ Veuillez sélectionner une photo");return}const i=o[0].value,u=o[1].value,p=d[0].value,m=o[2].value,h=n[0].value,s=n[1].value,B=o[3].value.split(",").map(r=>r.trim()).filter(r=>r);try{const r=q(D,`articles/${Date.now()}_${l.name}`);await k(r,l);const S=await $(r);await v(g(y,"articles"),{title:i,author:u,level:p,projectName:m,description:h,photoDescription:s,photoURL:S,format:"photo",tags:B,status:"published",userId:a.uid,createdAt:b()}),alert("✅ Photo publiée avec succès!"),e.reset()}catch(r){alert(`❌ Erreur: ${r.message}`)}})}A&&A.addEventListener("click",async()=>{await x(I),window.location.href="/login"});
